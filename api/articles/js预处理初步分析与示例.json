{"title":"js预处理初步分析与示例","slug":"js预处理初步分析与示例","date":"2018-01-14T12:32:56.000Z","updated":"2018-01-14T14:05:03.330Z","comments":true,"path":"api/articles/js预处理初步分析与示例.json","photos":[],"link":"","excerpt":null,"covers":null,"content":"<p>JavaScript是一种描述型的脚本语言，它不同于java或C#等编译性语言,它不需要进行编译成中间语言,而是由浏览器进行动态地解析与执行。</p>\n<p>代码并非由解析器直接逐行执行，所以理解javaScript语言的运行机制，掌握javascript的执行顺序，有利于我们学好JavaScript。</p>\n<p>预处理（预编译）阶段：创建一个词法环境（LexicalEnvironment，在后面简写为LE），扫描代码中的用声明的方式声明的函数，和var定义的变量，并将它们加到预处理阶段的LE中去。</p>\n<p>比如下面这段代码：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var a = 10;(var定义的变量）</span><br><span class=\"line\"></span><br><span class=\"line\">function b( )&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(&apos;这是一个声明方式声明的函数&apos;)</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>解析器在对代码进行预处理时，在全局LE中添加了如下内容：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">LE&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">a = undefinded;</span><br><span class=\"line\"></span><br><span class=\"line\">function b( )&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    console.log(&apos;这是一个声明方式声明的函数&apos;)</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>注意：在预处理阶段，以赋值方式创建的函数不会被添加到LE中去，而是将变量添加到LE，且值为undefinded。待代码执行上下文时才对该变量赋值（匿名函数）</p>\n<p>比如：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">console.log(a);</span><br><span class=\"line\"></span><br><span class=\"line\">var a = function( )&#123; &#125;</span><br></pre></td></tr></table></figure>\n<p>其结果为 undefinded；</p>\n<p>说明：全局预处理阶段在代码执行阶段前完成，并将代码中\b声明的变量 和 声明方式创建的函数加入全局的LE中（或等价于window） ，其中的变量即为全局变量。同时也解释了声明函数可在任意位置调用，而以表达式创建的函数（如构造函数的原型方法）必须在调用前声明。</p>\n<p>我们还可以通过在浏览器的控制台中输入window. + “变量名”的方式确认该变量。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var a;</span><br><span class=\"line\"></span><br><span class=\"line\">function b( )&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(‘这是一个声明方式声明的函数’）</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>下面我们来做一个练习：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">console.log(a);</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(b);</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(c);</span><br><span class=\"line\"></span><br><span class=\"line\">console.log(d);</span><br><span class=\"line\"></span><br><span class=\"line\">var a = 10;</span><br><span class=\"line\"></span><br><span class=\"line\">b = 15;</span><br><span class=\"line\"></span><br><span class=\"line\">function c( )&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">var d = function( )&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>在预处理阶段做了这些事：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">LE&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">a = undefinded;</span><br><span class=\"line\"></span><br><span class=\"line\">b没有被添加到LE中，所以这行会报错 b is not definded</span><br><span class=\"line\"></span><br><span class=\"line\">指向函数</span><br><span class=\"line\"></span><br><span class=\"line\">d不是声明方式创建的函数，所以d = undefinded</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>结果为：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">undefinded</span><br><span class=\"line\"></span><br><span class=\"line\">报错</span><br><span class=\"line\"></span><br><span class=\"line\">function c( )&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">undefinded</span><br></pre></td></tr></table></figure>\n","categories":[],"tags":[]}